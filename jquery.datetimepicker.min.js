/**
* @version: 1.0.0
* @author: Aleksi Smith Cendron
* @copyright: Copyright (c) 2017-2017 Aleksi Smith Cendron. All rights reserved.
* @license: Licensed under the MIT license. See http://www.opensource.org/licenses/mit-license.php
* @website: https://github.com/Alexitaly92/jquery.datetimepicker
*/
!function(e,t){if("function"==typeof define&&define.amd)define(["moment","jquery"],function(i,a){return e.datetimepicker=t(i,a)});else if("object"==typeof module&&module.exports){var i="undefined"!=typeof window?window.jQuery:void 0;i||(i=require("jquery"),i.fn||(i.fn={})),module.exports=t(require("moment"),i)}else e.datetimepicker=t(e.moment,e.jQuery)}(this,function(e,t){var i=function(i,a,n){this.element=t(i),this.parentEl="body",this.locale="en",this.Date=e().clone().startOf("day"),this.inline=!1,this.onlyForward=!1,this.daysOfWeek=[1,2,3,4,5,6,7],this.timePicker=!0,this.timePickerIncrement=1,this.timePickerSeconds=!1,this.timePickerIgnoreRanges=[],this.calendar={},this.rangesToIgnore=[],this.SelectedDateTime=null,this.callback=function(){},("object"!=typeof a||null===a)&&(a={}),this.parentEl=t(a.parentEl&&t(a.parentEl).length?a.parentEl:this.parentEl),"string"==typeof a.locale&&(this.locale=a.locale),e.locale(this.locale),this.Date=e().clone().startOf("day"),"object"==typeof a.Date&&(this.Date=a.Date.startOf("day").clone()),"boolean"==typeof a.inline&&(this.inline=a.inline),"boolean"==typeof a.onlyForward&&(this.onlyForward=a.onlyForward),"object"==typeof a.daysOfWeek&&(this.daysOfWeek=a.daysOfWeek),"boolean"==typeof a.timePicker&&(this.timePicker=a.timePicker),"number"==typeof a.timePickerIncrement&&(this.timePickerIncrement=a.timePickerIncrement),"boolean"==typeof a.timePickerSeconds&&(this.timePickerSeconds=a.timePickerSeconds),"object"==typeof a.timePickerIgnoreRanges&&(this.timePickerIgnoreRanges=a.timePickerIgnoreRanges),"function"==typeof n&&(this.callback=n),this.container=this.generateTemplate(),this.container.hide(),this.timePicker&&this.generateRangesToIgnore(),this.generateCalendar(),t(this.parentEl).append(this.container),this.element.on("click",t.proxy(function(e){this.showCalendar(),e.stopPropagation()},this)),t(document).on("click",t.proxy(function(e){this.documentClick(e)},this)),this.element.attr("readonly","readonly"),this.element.css("cursor","text")};return i.prototype={constructor:i,generateTemplate:function(){var e=t("<div>",{"class":"datetimepicker dropdown-menu"});if(this.inline&&e.addClass("inline"),this.timePicker){var i=t("<div>",{"class":"datetimepicker-timepickerhead"});i.append(t("<i>",{"class":"fa fa-clock-o",style:"inline"}));var a=t("<select>",{id:"seltime"});a.on("change",t.proxy(this.timeSelected,this)),i.append(a),e.append(i)}var n=t("<div>",{"class":"datetimepicker-head"}),s=t("<div>",{"class":"left-head"}),r=t("<i>",{"class":"fa fa-angle-left"});s.on("click",t.proxy(this.moveLeft,this)),s.html(r),n.append(s),n.append(t("<div>",{"class":"mid-head"}));var d=t("<div>",{"class":"right-head"}),o=t("<i>",{"class":"fa fa-angle-right fa-2"});d.on("click",t.proxy(this.moveRight,this)),d.html(o),n.append(d),e.append(n);for(var l=t("<table>",{"class":"datetable"}),h=t("<thead>"),c=t("<tr>"),m=0;7>m;m++)c.append(t("<th>",{"class":"daycolumn",id:"week-"+m}));h.append(c),l.append(h);for(var f=t("<tbody>"),y=0;6>y;y++){for(var c=t("<tr>",{id:"weekdays-"+y}),m=0;7>m;m++){var u=t("<td>",{"class":"daycell",id:"day-"+y+m});u.on("click",t.proxy(this.cellClicked,this,u.attr("id"))),c.append(u)}f.append(c)}return l.append(f),e.append(l),e},setPosition:function(){for(var e=this.element;1==e.parent().children().length;)e=e.parent();var t=e.offset(),i=e.height();t.top+=i+5,this.container.css(t)},generateCalendar:function(){var e=this.Date.clone().startOf("month").startOf("week"),t=this.Date.clone().endOf("month").endOf("week").add(1,"week");e.isSame(this.Date.clone().startOf("month"))&&(e.subtract(1,"week"),t.subtract(1,"week"));var i=e.clone();for(this.calendar.TextMonth=this.Date.format("MMMM YYYY"),this.calendar.Days=[],this.calendar.Times=[];i.isBefore(t);)this.calendar.Days.push(i.clone()),i.add(1,"day");if(this.timePicker)for(e=this.Date.clone().startOf("day"),t=this.Date.clone().endOf("day"),i=e.clone();i.isBefore(t);)this.checkValidHour(i)&&this.calendar.Times.push(i.clone()),i.add(this.timePickerIncrement,"minute")},generateRangesToIgnore:function(){this.ignoreRanges=[];for(var t=0;t<this.timePickerIgnoreRanges.length;t++){var i=null,a=null,n=e.localeData()._longDateFormat.LT;i=e(this.timePickerIgnoreRanges[t].startTime,n),a=e(this.timePickerIgnoreRanges[t].endTime,n),this.ignoreRanges.push({start:i,end:a})}},checkValidHour:function(e){for(var t=0;t<this.ignoreRanges.length;t++){var i=e.hour(),a=e.minute(),n=this.ignoreRanges[t].start.hour(),s=this.ignoreRanges[t].start.minute(),r=this.ignoreRanges[t].end.hour(),d=this.ignoreRanges[t].end.minute();if(i>n&&r>i)return!1;if(i==n&&a>=s)return!1;if(i==r&&d>a)return!1}return!0},documentClick:function(e){this.container&&!this.container.is(e.target)&&0==this.container.has(e.target).length&&this.container.hide()},showCalendar:function(){this.container.find(".mid-head").html(this.calendar.TextMonth);for(var i=this.container.find(".datetable"),a=0;7>a;a++)i.find("#week-"+a).html(this.calendar.Days[a].format("ddd"));for(var n=(t("<tbody>"),0),s=0;6>s;s++)for(var a=0;7>a;a++)i.find("#day-"+s+a).removeClass(),i.find("#day-"+s+a).addClass("daycell"),this.SelectedDateTime&&this.SelectedDateTime.clone().startOf("day").isSame(this.calendar.Days[n])&&i.find("#day-"+s+a).addClass("selected"),i.find("#day-"+s+a).html(this.calendar.Days[n].format("DD")),i.find("#day-"+s+a).data("date")&&i.find("#day-"+s+a).data("date",null),i.find("#day-"+s+a).data("date",this.calendar.Days[n].clone()),e().startOf("day").isSame(this.calendar.Days[n])&&i.find("#day-"+s+a).addClass("today"),this.calendar.Days[n].month()==this.Date.month()&&i.find("#day-"+s+a).addClass("samemonth"),this.calendar.Days[n].isBefore(this.Date)&&this.calendar.Days[n].month()!=this.Date.month()&&i.find("#day-"+s+a).addClass("monthbefore"),this.calendar.Days[n].isAfter(this.Date)&&this.calendar.Days[n].month()!=this.Date.month()&&i.find("#day-"+s+a).addClass("monthafter"),(-1==t.inArray(this.calendar.Days[n].isoWeekday(),this.daysOfWeek)||this.onlyForward&&this.calendar.Days[n].isBefore(e().startOf("day")))&&i.find("#day-"+s+a).addClass("invaliddate"),n++;for(this.container.find("#seltime").html(""),a=0;a<this.calendar.Times.length;a++){var r=t("<option>",{text:this.calendar.Times[a].format("LT"),value:this.calendar.Times[a].format("LT")});this.SelectedDateTime&&this.calendar.Times[a].format("LT")==this.SelectedDateTime.format("LT")&&r.attr("selected","selected"),this.container.find("#seltime").append(r)}null==this.SelectedDateTime?this.container.find("#seltime").attr("disabled","disabled"):this.container.find("#seltime").removeAttr("disabled"),this.setPosition(),this.container.show()},hideCalendar:function(){this.container.hide()},cellClicked:function(e){var t=this.container.find("#"+e).data("date").clone();return this.container.find("#"+e).hasClass("invaliddate")||this.daySelected(e),t.isAfter(this.Date)&&t.month()!=this.Date.month()?void this.moveRight():t.isBefore(this.Date)&&t.month()!=this.Date.month()?void this.moveLeft():void 0},moveLeft:function(){this.Date=this.Date.clone().subtract(1,"month"),this.generateCalendar(),this.showCalendar()},moveRight:function(){this.Date=this.Date.clone().add(1,"month"),this.generateCalendar(),this.showCalendar()},timeSelected:function(){var t=e.localeData()._longDateFormat.LT,i=e(this.container.find("#seltime").find(":selected").val(),t);this.SelectedDateTime&&(this.SelectedDateTime.hour(i.hour()).minute(i.minute()),this.element.val(this.SelectedDateTime.format("L LT")),this.callback(this.SelectedDateTime))},daySelected:function(i){this.container.find(".daycell.selected").removeClass("selected");var a=this.container.find("#"+i);a.addClass("selected"),this.SelectedDateTime=a.data("date").clone();var n="L";if(this.timePicker){n+=" LT";var s=e.localeData()._longDateFormat.LT;if(this.onlyForward)if(this.SelectedDateTime.isSame(e().startOf("day"))){this.container.find("#seltime").children().each(function(i,a){var n=e(t(a).val(),s);n.isBefore(e())&&t(a).attr("disabled","disabled")});var r=e(this.container.find("#seltime").find(":selected").val(),s);r.isBefore(e())?(this.container.find("#seltime").children().removeAttr("selected"),this.container.find("#seltime").trigger("change")):this.SelectedDateTime.hour(r.hour()).minute(r.minute())}else{this.container.find("#seltime").children().removeAttr("disabled");var r=e(this.container.find("#seltime").find(":selected").val(),s);this.SelectedDateTime.hour(r.hour()).minute(r.minute())}}this.container.find("#seltime").removeAttr("disabled"),this.element.val(this.SelectedDateTime.format(n)),this.callback(this.SelectedDateTime)}},t.fn.datetimepicker=function(e,a){return this.each(function(){var n=t(this);n.data("datetimepicker")&&n.data("datetimepicker").remove(),n.data("datetimepicker",new i(n,e,a))}),this},i});